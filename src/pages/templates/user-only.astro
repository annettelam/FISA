---
import Layout from '../layouts/Layout.astro';
import { authMiddleware } from '../middleware/auth.js';

// Invoke the middleware with the current request and require authentication
const { authenticated, user, redirectTo } = await authMiddleware(Astro.request, { requireAuth: true });

if (!authenticated) {
  return Astro.redirect(redirectTo);
}
---