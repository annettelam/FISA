---
import Layout from '../layouts/Layout.astro';
import { authMiddleware } from '../middleware/auth.js';

const { authenticated, user, redirectTo } = await authMiddleware(Astro.request, { requireAuth: true, requireAdmin: true });

if (!authenticated) {
  return Astro.redirect(redirectTo);
}
---

<Layout title="Admin Page">
  <h1>Admin Dashboard</h1>
  <p>Welcome, {user.email}! You have admin access.</p>
  <a href="/api/auth/signout" style="color: blue;">Logout</a>
</Layout>
